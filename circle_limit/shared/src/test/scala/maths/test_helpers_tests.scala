package circle_limit.maths

import utest._

import spire.implicits._

import Imaginary.i

import TestHelpers.checkSetsOfMoebiusTransformationAlmostEqual

object CheckSetsOfMoebiusTransformationsAlmostEqual extends TestSuite {

  val tests = TestSuite {

    "Empty set is almost equal to the empty set." - {
      val set1 = Set[MoebiusTransformation]()
      val set2 = Set[MoebiusTransformation]()
      assert (
        checkSetsOfMoebiusTransformationAlmostEqual(set1, set2)
      )
    }

    "Sets almost equal if elements are almost equal" - {
      val set1 = Set(
        MoebiusTransformation(
          -0.6068072407032272 + 6.04794368359524727*i,
          0.0055050801181003 + 7.3975392397193067*i,
          -8.5410362205371368 + 8.22379800169699995*i,
          91.895627962623881 + 1.9187422792593443*i
        ),
        MoebiusTransformation(
          0.2062072401072255 + 4.04494168029824927*i,
          1.4565750809181804 - 0.4775894393197067*i,
          1.5310362005361362 - 0.22470234275677775*i,
          7.845567575673881 + 1.9187422756793443*i
        ),
        MoebiusTransformation(
          2.2533372406572255 + 3.04567165629856925*i,
          -45.4565750809185504 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677775*i,
          7.845566873577751 - 1.9145456756793563*i
        )
      )
      val set2 = Set(
        MoebiusTransformation(
          -0.6068072407032277 + 6.04794368359524727*i,
          0.0055050801181007 + 7.3975392397193037*i,
          -8.5410362205371368 + 8.22379800169699935*i,
          91.895627962623861 + 1.9187422792593444*i
        ),
        MoebiusTransformation(
          0.2062072401072252 + 4.04494168029824920*i,
          1.4565750809181804 - 0.4775894393197067*i,
          1.5310362005361367 - 0.22470234275677777*i,
          7.845567575673880 + 1.9187422756793443*i
        ),
        MoebiusTransformation(
          2.2533372406572225 + 3.04567165629856925*i,
          -45.4565750809185502 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677779*i,
          7.845566873577753 - 1.9145456756793563*i
        )
      ) // only the last two digits of some entries vary

      assert (
        checkSetsOfMoebiusTransformationAlmostEqual(set1, set2)
      )

    }

    "Sets not almost equal if one element of each set differs" - {
      val set1 = Set(
        MoebiusTransformation(
          -0.3062072401072272 + 0.04494168029824927*i,
          1.0085050809181804 + 0.4775894393197067*i,
          -1.5310362005361362 + 0.22470840149124635*i,
          1.845627962623881 + 1.9187422792593443*i
        ),
        MoebiusTransformation(
          0.2062072401072255 + 4.04494168029824927*i,
          1.4565750809181804 - 0.4775894393197067*i,
          1.5310362005361362 - 0.22470234275677775*i, // This is the entry that differs from below
          7.845567575673881 + 1.9187422756793443*i
        ),
        MoebiusTransformation(
          2.2533372406572255 + 3.04567165629856925*i,
          -45.4565750809185504 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677775*i,
          7.845566873577751 - 1.9145456756793563*i
        )
      )
      val set2 = Set(
        MoebiusTransformation(
          -0.3062072401072272 + 0.04494168029824927*i,
          1.0085050809181804 + 0.4775894393197067*i,
          -1.5310362005361362 + 0.22470840149124635*i,
          1.845627962623881 + 1.9187422792593443*i
        ),
        MoebiusTransformation(
          0.2062072401072255 + 4.04494168029824927*i,
          1.4565750809181804 - 0.4775894393197067*i,
          1.7310362005361362 - 0.22470234275677775*i, // This is the entry that differs from above
          7.845567575673881 + 1.9187422756793443*i
        ),
        MoebiusTransformation(
          2.2533372406572255 + 3.04567165629856925*i,
          -45.4565750809185504 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677775*i,
          7.845566873577751 - 1.9145456756793563*i
        )
      )

      assert (
        ! checkSetsOfMoebiusTransformationAlmostEqual(set1, set2)
      )

    }

    "Sets not almost equal if first is almost equal to a proper subset of the second" - {
      val set1 = Set(
        MoebiusTransformation(
          -0.6068072407032272 + 6.04794368359524727*i,
          0.0055050801181003 + 7.3975392397193067*i,
          -8.5410362205371368 + 8.22379800169699995*i,
          91.895627962623881 + 1.9187422792593443*i
        ),
        MoebiusTransformation(
          2.2533372406572255 + 3.04567165629856925*i,
          -45.4565750809185504 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677775*i,
          7.845566873577751 - 1.9145456756793563*i
        )
      )
      val set2 = Set(
        MoebiusTransformation(
          -0.6068072407032277 + 6.04794368359524727*i,
          0.0055050801181007 + 7.3975392397193037*i,
          -8.5410362205371368 + 8.22379800169699935*i,
          91.895627962623861 + 1.9187422792593444*i
        ),
        MoebiusTransformation(
          0.2062072401072252 + 4.04494168029824920*i,
          1.4565750809181804 - 0.4775894393197067*i,
          1.5310362005361367 - 0.22470234275677777*i,
          7.845567575673880 + 1.9187422756793443*i
        ),
        MoebiusTransformation(
          2.2533372406572225 + 3.04567165629856925*i,
          -45.4565750809185502 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677779*i,
          7.845566873577753 - 1.9145456756793563*i
        )
      )

      assert (
        ! checkSetsOfMoebiusTransformationAlmostEqual(set1, set2)
      )

    }

    "Sets not almost equal if second is almost equal to a proper subset of the first" - {
      val set1 = Set(
        MoebiusTransformation(
          -0.6068072407032272 + 6.04794368359524727*i,
          0.0055050801181003 + 7.3975392397193067*i,
          -8.5410362205371368 + 8.22379800169699995*i,
          91.895627962623881 + 1.9187422792593443*i
        ),
        MoebiusTransformation(
          0.2062072401072252 + 4.04494168029824920*i,
          1.4565750809181804 - 0.4775894393197067*i,
          1.5310362005361367 - 0.22470234275677777*i,
          7.845567575673880 + 1.9187422756793443*i
        ),
        MoebiusTransformation(
          2.2533372406572255 + 3.04567165629856925*i,
          -45.4565750809185504 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677775*i,
          7.845566873577751 - 1.9145456756793563*i
        )
      )
      val set2 = Set(
        MoebiusTransformation(
          -0.6068072407032277 + 6.04794368359524727*i,
          0.0055050801181007 + 7.3975392397193037*i,
          -8.5410362205371368 + 8.22379800169699935*i,
          91.895627962623861 + 1.9187422792593444*i
        ),
        MoebiusTransformation(
          2.2533372406572225 + 3.04567165629856925*i,
          -45.4565750809185502 - 0.4774794333147556*i,
          1.5310362005361352 + 54.24560456254677779*i,
          7.845566873577753 - 1.9145456756793563*i
        )
      )

      assert (
        ! checkSetsOfMoebiusTransformationAlmostEqual(set1, set2)
      )

    }
  }
}
